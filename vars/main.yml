# https://netbox.readthedocs.io/en/stable/installation/3-netbox/#allowed_hosts
# https://blog.crisp.se/2016/10/20/maxwenzin/how-to-append-to-lists-in-ansible
ALLOWED_HOSTS: "{{ lookup('community.general.passwordstore', 'hosts/armant/docker/netbox/info subkey=ALLOWED_HOSTS') + netbox.config.default_allowed_hosts }}"

# https://netbox.readthedocs.io/en/stable/installation/3-netbox/#database
DB_NAME: netbox
DB_USER: netbox
DB_PASSWORD: "{{ lookup('community.general.passwordstore', 'hosts/armant/docker/netbox/postgresql') }}"
DB_HOST: localhost
DB_PORT: 5432

# https://netbox.readthedocs.io/en/stable/installation/3-netbox/#secret_key
SECRET_KEY: "{{ lookup('community.general.passwordstore', 'hosts/armant/docker/netbox/info subkey=SECRET_KEY') }}"

SUPERUSER_EMAIL: "{{ lookup('community.general.passwordstore', 'hosts/armant/docker/netbox/users/admin subkey=email') }}"
SUPERUSER_USER: "{{ lookup('community.general.passwordstore', 'hosts/armant/docker/netbox/users/admin subkey=usr') }}"
SUPERUSER_NAME: "{{ lookup('community.general.passwordstore', 'hosts/armant/docker/netbox/users/admin subkey=name') }}"
SUPERUSER_PASSWORD: "{{ lookup('community.general.passwordstore', 'hosts/armant/docker/netbox/users/admin') }}"
SUPERUSER_API_TOKEN: "{{ lookup('community.general.passwordstore', 'hosts/armant/docker/netbox/info subkey=SUPERUSER_API_TOKEN') }}"

EMAIL_SERVER: "{{ lookup('community.general.passwordstore', 'hosts/armant/docker/netbox/info subkey=EMAIL_SERVER') }}"
EMAIL_PORT: 587
EMAIL_USERNAME: "{{ lookup('community.general.passwordstore', 'hosts/armant/docker/netbox/info subkey=EMAIL_USERNAME') }}"
EMAIL_PASSWORD: "{{ lookup('community.general.passwordstore', 'hosts/armant/docker/netbox/info subkey=EMAIL_PASSWORD') }}"
EMAIL_FROM: "{{ lookup('community.general.passwordstore', 'hosts/armant/docker/netbox/info subkey=EMAIL_FROM') }}"

# Setting this to True will permit only authenticated users to access any part of NetBox
LOGIN_REQUIRED: true

# it does not look like Netbox supports Redis socket (we are limited to IP port)
# https://github.com/netbox-community/netbox/issues/4377
REDIS_PASSWORD: "{{ lookup('community.general.passwordstore', 'hosts/armant/docker/netbox/redis') }}"
